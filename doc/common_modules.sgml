<chapter>
<title>Common modules</title>

<sect1>
<title>SFV module</title>

<simplesect>
<title>Description</title>
<para>
This modules comes with some utilities functions to handle sfv files, and associated files (diz,
zip, etc).
</para>
<para>
When a SFV file is uploaded, server will create <computeroutput>.missing</computeroutput> files.
</para>
<para>
If the file is corrupted, a <computeroutput>.bad</computeroutput> file will be
created.</para>
<para>
HINT: when uploading dirs, be sure to upload SFV file first. The server will
automatically check files as they are uploaded, and update a progress bar
to quickly see how many percent are done.</para>
<para>
NOTE to w_nd0ws users: although a (stupid) os can give you bad habits,
files <emphasis>ARE CASE SENSITIVE !</emphasis></para>
</simplesect>

<simplesect>
<title>What is a SFV file ?</title>
<para>
A SFV file is a small verification file added to dirs, that stores records
about a file or group of files integrity. When you compare a SFV file against
a group of rar files it will check those rar files and tell you if they are
complete or if they are "broken".</para>
<para>
This is done by calculating a 32-bits checksum (*nix users already know
md5 sums, this is similar - with a different algorithm).
</para>
</simplesect>

<simplesect>
<title>Installation</title>
<para>
Just add the line
<screen>module = /path/to/libwzd_sfv.so</screen>
in your config file.
</para>
</simplesect>

<simplesect>
<title>Parameters</title>
<para>
The following parameters are available, you can set them in the config file (don't forget the prefix
<emphasis>param_</emphasis>).</para>
<itemizedlist>
<listitem><screen>sfv_progressmeter</screen>
<para>This dir is created during the upload, when the release isn't complete, to indicate the
progression.</para></listitem>
<listitem><screen>sfv_del_progressmeter</screen>
<para>This regex must match the progressmeter, and is used to find and delete it when the number of
files has changed.
</para></listitem>
<listitem><screen>sfv_incomplete_indicator</screen>
<para>This will be a simlink created to indicate that the release isn't complete.
</para></listitem>
<listitem><screen>sfv_other_completebar</screen>
<para>This dir will be created when release is complete.
</para></listitem>
</itemizedlist>
<para>e.g: <screen>param_sfv_progressmeter = [WzD] - %3d%% Complete - [WzD]</screen>
</para>
</simplesect>

<simplesect>
<title>Features</title>
<itemizedlist>
<listitem><para>
When a SFV file is uploaded, an empty file is created for each name present in
the SFV file, with '.missing' appended.
</para></listitem>
<listitem><para>
If a SFV file is present, each file uploaded (and present in sfv) is checked,
and marqued as bad if checksums doesn't match (.missing are removed).
</para></listitem>
<listitem><para>
A "progress bar" is maintained after each upload, to inform on the progression
of the upload. It uses the <emphasis>number of files</emphasis> to calculate
percent.
</para></listitem>
<listitem><para>
A symbolic link is created to mark the upload as incomplete (and will be
removed when complete).
</para></listitem>
<listitem><para>
When a zip file is uploaded, it is checked, and marqued as bad if corrupted.
</para></listitem>
<listitem><para>
When a diz file is uploaded, it is parsed, and the module tries to guess to number of files to be
uploaded.
</para></listitem>
</itemizedlist>
</simplesect>

<simplesect>
<title>Available commands</title>
<itemizedlist>
<listitem><screen>site sfv check sfv_name</screen>
<para>Checks the specified sfv file. All missing or bad files will be marked
as usual.</para></listitem>
<listitem><screen>site sfv create sfv_name</screen>
<para>Creates a SFV file in current dir.
</para></listitem>
</itemizedlist>
</simplesect>

</sect1>

</chapter>
